<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</title>
  <meta name="description" content="课程bookdown" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="课程bookdown" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 第十二讲：数据可视化进阶 | R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)" />
  
  <meta name="twitter:description" content="课程bookdown" />
  

<meta name="author" content="胡传鹏(等)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第十一讲回归模型四中介分析.html"/>
<link rel="next" href="第十三讲基于网络模型的心理学研究.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
<script src="libs/panelset-0.2.6/panelset.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R语言在心理学研究中的应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>引言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#开放电子书的初衷"><i class="fa fa-check"></i><b>0.1</b> 开放电子书的初衷</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#如何帮助完善本书"><i class="fa fa-check"></i><b>0.2</b> 如何帮助完善本书</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#使用许可"><i class="fa fa-check"></i><b>0.3</b> 使用许可</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#目录"><i class="fa fa-check"></i><b>0.4</b> 目录</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="关于作者.html"><a href="关于作者.html"><i class="fa fa-check"></i>关于作者</a>
<ul>
<li class="chapter" data-level="0.5" data-path="关于作者.html"><a href="关于作者.html#春季学期助教及电子书转录志愿者"><i class="fa fa-check"></i><b>0.5</b> 2024春季学期助教及电子书转录志愿者：</a></li>
<li class="chapter" data-level="0.6" data-path="关于作者.html"><a href="关于作者.html#春季学期助教"><i class="fa fa-check"></i><b>0.6</b> 2023春季学期助教：</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="lesson-1.html"><a href="lesson-1.html"><i class="fa fa-check"></i><b>1</b> 第一讲：为什么要学习R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lesson-1.html"><a href="lesson-1.html#r在心理科学及社会科学中的运用"><i class="fa fa-check"></i><b>1.1</b> R在心理科学及社会科学中的运用</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science"><i class="fa fa-check"></i><b>1.1.1</b> 数据科学</a></li>
<li class="chapter" data-level="1.1.2" data-path="lesson-1.html"><a href="lesson-1.html#id_1-data-science-born"><i class="fa fa-check"></i><b>1.1.2</b> 数据科学的诞生——数字化时代</a></li>
<li class="chapter" data-level="1.1.3" data-path="lesson-1.html"><a href="lesson-1.html#为什么要学习r语言1-why-learn-r"><i class="fa fa-check"></i><b>1.1.3</b> 为什么要学习R语言？{1-why-learn-R}</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lesson-1.html"><a href="lesson-1.html#r语言使用的示例展示"><i class="fa fa-check"></i><b>1.2</b> R语言使用的示例展示</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lesson-1.html"><a href="lesson-1.html#数据清洗"><i class="fa fa-check"></i><b>1.2.1</b> 数据清洗</a></li>
<li class="chapter" data-level="1.2.2" data-path="lesson-1.html"><a href="lesson-1.html#ggplot2画图"><i class="fa fa-check"></i><b>1.2.2</b> ggplot2画图</a></li>
<li class="chapter" data-level="1.2.3" data-path="lesson-1.html"><a href="lesson-1.html#心理学数据分析与结果汇报"><i class="fa fa-check"></i><b>1.2.3</b> 心理学数据分析与结果汇报</a></li>
<li class="chapter" data-level="1.2.4" data-path="lesson-1.html"><a href="lesson-1.html#regression"><i class="fa fa-check"></i><b>1.2.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lesson-1.html"><a href="lesson-1.html#现场运行代码"><i class="fa fa-check"></i><b>1.3</b> 现场运行代码</a></li>
<li class="chapter" data-level="1.4" data-path="lesson-1.html"><a href="lesson-1.html#课程安排"><i class="fa fa-check"></i><b>1.4</b> 课程安排</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="lesson-1.html"><a href="lesson-1.html#课程大纲"><i class="fa fa-check"></i><b>1.4.1</b> 课程大纲</a></li>
<li class="chapter" data-level="1.4.2" data-path="lesson-1.html"><a href="lesson-1.html#成绩分配"><i class="fa fa-check"></i><b>1.4.2</b> 成绩分配</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="lesson-1.html"><a href="lesson-1.html#如何学好这门课"><i class="fa fa-check"></i><b>1.5</b> 如何学好这门课</a></li>
<li class="chapter" data-level="1.6" data-path="lesson-1.html"><a href="lesson-1.html#课程总结与期望"><i class="fa fa-check"></i><b>1.6</b> 课程总结与期望</a></li>
<li class="chapter" data-level="1.7" data-path="lesson-1.html"><a href="lesson-1.html#推荐"><i class="fa fa-check"></i><b>1.7</b> 推荐</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html"><i class="fa fa-check"></i><b>2</b> 第二讲：如何开始使用R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#数据分析的出发点问题"><i class="fa fa-check"></i><b>2.1</b> 数据分析的出发点——问题</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题一-人类企鹅计划问卷数据"><i class="fa fa-check"></i><b>2.1.1</b> 问题一: 人类企鹅计划（问卷数据）</a></li>
<li class="chapter" data-level="2.1.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#问题二认知决策任务反应时和反应选择数据"><i class="fa fa-check"></i><b>2.1.2</b> 问题二：认知决策任务（反应时和反应选择数据）</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装r"><i class="fa fa-check"></i><b>2.2</b> 如何安装R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r的下载与安装"><i class="fa fa-check"></i><b>2.2.1</b> R的下载与安装</a></li>
<li class="chapter" data-level="2.2.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#r-console控制台"><i class="fa fa-check"></i><b>2.2.2</b> R console（控制台）</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何安装rstudio"><i class="fa fa-check"></i><b>2.3</b> 如何安装Rstudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#rstuio的下载与安装"><i class="fa fa-check"></i><b>2.3.1</b> Rstuio的下载与安装</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#测试rstudio"><i class="fa fa-check"></i><b>2.3.2</b> 测试Rstudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#创建新项目"><i class="fa fa-check"></i><b>2.3.3</b> 创建新项目</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#包packages的介绍与调用"><i class="fa fa-check"></i><b>2.3.4</b> 包(packages)的介绍与调用</a></li>
<li class="chapter" data-level="2.3.5" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#镜像的选择"><i class="fa fa-check"></i><b>2.3.5</b> 镜像的选择</a></li>
<li class="chapter" data-level="2.3.6" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#安装rtoolswindows"><i class="fa fa-check"></i><b>2.3.6</b> 安装Rtools（windows）</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二讲如何开始使用r.html"><a href="第二讲如何开始使用r.html#如何通过和鲸model-whale使用r"><i class="fa fa-check"></i><b>2.4</b> 如何通过和鲸（Model Whale）使用R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html"><i class="fa fa-check"></i><b>3</b> 第三讲：Git &amp; RStudio工作流</a>
<ul>
<li class="chapter" data-level="3.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#文件与文件夹结构系统"><i class="fa fa-check"></i><b>3.1</b> 文件与文件夹结构系统</a></li>
<li class="chapter" data-level="3.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-and-git-hub"><i class="fa fa-check"></i><b>3.2</b> Git and Git Hub</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git"><i class="fa fa-check"></i><b>3.2.1</b> Git</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#git-hub"><i class="fa fa-check"></i><b>3.2.2</b> Git Hub</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#local-version-control"><i class="fa fa-check"></i><b>3.3</b> Local Version Control</a></li>
<li class="chapter" data-level="3.4" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#remote-version-control"><i class="fa fa-check"></i><b>3.4</b> Remote Version Control</a></li>
<li class="chapter" data-level="3.5" data-path="第三讲git-rstudio工作流.html"><a href="第三讲git-rstudio工作流.html#作业"><i class="fa fa-check"></i><b>3.5</b> 作业</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html"><i class="fa fa-check"></i><b>4</b> 第四讲：如何导入数据</a>
<ul>
<li class="chapter" data-level="4.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#正式开始前的tips"><i class="fa fa-check"></i><b>4.1</b> 正式开始前的Tips</a></li>
<li class="chapter" data-level="4.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#回顾与问题"><i class="fa fa-check"></i><b>4.2</b> 回顾与问题</a></li>
<li class="chapter" data-level="4.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据导入"><i class="fa fa-check"></i><b>4.3</b> 数据导入</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据的住址路径-以mac系统为例"><i class="fa fa-check"></i><b>4.3.1</b> 数据的“住址”——路径 (以Mac系统为例)</a></li>
<li class="chapter" data-level="4.3.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#绝对路径相对路径"><i class="fa fa-check"></i><b>4.3.2</b> 绝对路径/相对路径</a></li>
<li class="chapter" data-level="4.3.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#设定工作目录-手动挡与自动挡"><i class="fa fa-check"></i><b>4.3.3</b> 设定工作目录 – 手动挡与自动挡</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据"><i class="fa fa-check"></i><b>4.4</b> 读取数据</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据手动档"><i class="fa fa-check"></i><b>4.4.1</b> 读取数据——手动档</a></li>
<li class="chapter" data-level="4.4.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#读取数据自动挡gui点击操作"><i class="fa fa-check"></i><b>4.4.2</b> 读取数据——自动挡(GUI点击操作)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型"><i class="fa fa-check"></i><b>4.5</b> 数据类型</a></li>
<li class="chapter" data-level="4.6" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据结构"><i class="fa fa-check"></i><b>4.6</b> 数据结构</a></li>
<li class="chapter" data-level="4.7" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引"><i class="fa fa-check"></i><b>4.7</b> 数据索引</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引中括号"><i class="fa fa-check"></i><b>4.7.1</b> 数据索引(中括号)</a></li>
<li class="chapter" data-level="4.7.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引-1"><i class="fa fa-check"></i><b>4.7.2</b> 数据索引($)</a></li>
<li class="chapter" data-level="4.7.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据索引逻辑值"><i class="fa fa-check"></i><b>4.7.3</b> 数据索引(逻辑值)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象object"><i class="fa fa-check"></i><b>4.8</b> 对象（object）</a></li>
<li class="chapter" data-level="4.9" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#其它注意事项"><i class="fa fa-check"></i><b>4.9</b> 其它注意事项</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#变量命名"><i class="fa fa-check"></i><b>4.9.1</b> 变量命名</a></li>
<li class="chapter" data-level="4.9.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#缺失值na-空值null"><i class="fa fa-check"></i><b>4.9.2</b> 缺失值（NA） 空值（NULL）</a></li>
<li class="chapter" data-level="4.9.3" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#数据类型的转换"><i class="fa fa-check"></i><b>4.9.3</b> 数据类型的转换</a></li>
<li class="chapter" data-level="4.9.4" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#目录和文件管理函数"><i class="fa fa-check"></i><b>4.9.4</b> 目录和文件管理函数:</a></li>
<li class="chapter" data-level="4.9.5" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#对象与变量名"><i class="fa fa-check"></i><b>4.9.5</b> 对象与变量名</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#final-project期末作业"><i class="fa fa-check"></i><b>4.10</b> final project（期末作业）</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#requirements"><i class="fa fa-check"></i><b>4.10.1</b> Requirements</a></li>
<li class="chapter" data-level="4.10.2" data-path="第四讲如何导入数据.html"><a href="第四讲如何导入数据.html#评分标准"><i class="fa fa-check"></i><b>4.10.2</b> 评分标准</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>5</b> 第五讲：R语言中的对象2: 函数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lesson-5.html"><a href="lesson-5.html#加载数据"><i class="fa fa-check"></i><b>5.1</b> 加载数据</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lesson-5.html"><a href="lesson-5.html#数据的地址路径"><i class="fa fa-check"></i><b>5.1.1</b> 数据的“地址”——路径</a></li>
<li class="chapter" data-level="5.1.2" data-path="lesson-5.html"><a href="lesson-5.html#绝对路径与相对路径"><i class="fa fa-check"></i><b>5.1.2</b> 绝对路径与相对路径</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lesson-5.html"><a href="lesson-5.html#读取数据-1"><i class="fa fa-check"></i><b>5.2</b> 读取数据</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lesson-5.html"><a href="lesson-5.html#手动导入"><i class="fa fa-check"></i><b>5.2.1</b> 手动导入</a></li>
<li class="chapter" data-level="5.2.2" data-path="lesson-5.html"><a href="lesson-5.html#代码导入"><i class="fa fa-check"></i><b>5.2.2</b> 代码导入</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lesson-5.html"><a href="lesson-5.html#赋值"><i class="fa fa-check"></i><b>5.3</b> 赋值</a></li>
<li class="chapter" data-level="5.4" data-path="lesson-5.html"><a href="lesson-5.html#数据类型-1"><i class="fa fa-check"></i><b>5.4</b> 数据类型</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lesson-5.html"><a href="lesson-5.html#单个元素"><i class="fa fa-check"></i><b>5.4.1</b> 单个元素</a></li>
<li class="chapter" data-level="5.4.2" data-path="lesson-5.html"><a href="lesson-5.html#数值型numeric"><i class="fa fa-check"></i><b>5.4.2</b> 数值型(numeric)</a></li>
<li class="chapter" data-level="5.4.3" data-path="lesson-5.html"><a href="lesson-5.html#字符串character"><i class="fa fa-check"></i><b>5.4.3</b> 字符串(character)</a></li>
<li class="chapter" data-level="5.4.4" data-path="lesson-5.html"><a href="lesson-5.html#逻辑值logical"><i class="fa fa-check"></i><b>5.4.4</b> 逻辑值(logical)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lesson-5.html"><a href="lesson-5.html#数据结构-1"><i class="fa fa-check"></i><b>5.5</b> 数据结构</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lesson-5.html"><a href="lesson-5.html#向量vector"><i class="fa fa-check"></i><b>5.5.1</b> 向量(vector)</a></li>
<li class="chapter" data-level="5.5.2" data-path="lesson-5.html"><a href="lesson-5.html#类型转换"><i class="fa fa-check"></i><b>5.5.2</b> 类型转换</a></li>
<li class="chapter" data-level="5.5.3" data-path="lesson-5.html"><a href="lesson-5.html#向量循环"><i class="fa fa-check"></i><b>5.5.3</b> 向量循环</a></li>
<li class="chapter" data-level="5.5.4" data-path="lesson-5.html"><a href="lesson-5.html#向量的索引"><i class="fa fa-check"></i><b>5.5.4</b> 向量的索引</a></li>
<li class="chapter" data-level="5.5.5" data-path="lesson-5.html"><a href="lesson-5.html#因子factor"><i class="fa fa-check"></i><b>5.5.5</b> 因子(factor)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lesson-5.html"><a href="lesson-5.html#数据框"><i class="fa fa-check"></i><b>5.6</b> 数据框</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lesson-5.html"><a href="lesson-5.html#数据框的索引"><i class="fa fa-check"></i><b>5.6.1</b> 数据框的索引</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lesson-5.html"><a href="lesson-5.html#矩阵与数组"><i class="fa fa-check"></i><b>5.7</b> 矩阵与数组</a></li>
<li class="chapter" data-level="5.8" data-path="lesson-5.html"><a href="lesson-5.html#列表"><i class="fa fa-check"></i><b>5.8</b> 列表</a></li>
<li class="chapter" data-level="5.9" data-path="lesson-5.html"><a href="lesson-5.html#函数"><i class="fa fa-check"></i><b>5.9</b> 函数</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="lesson-5.html"><a href="lesson-5.html#函数的调用"><i class="fa fa-check"></i><b>5.9.1</b> 函数的调用</a></li>
<li class="chapter" data-level="5.9.2" data-path="lesson-5.html"><a href="lesson-5.html#自定义函数"><i class="fa fa-check"></i><b>5.9.2</b> 自定义函数</a></li>
<li class="chapter" data-level="5.9.3" data-path="lesson-5.html"><a href="lesson-5.html#函数的组成"><i class="fa fa-check"></i><b>5.9.3</b> 函数的组成</a></li>
<li class="chapter" data-level="5.9.4" data-path="lesson-5.html"><a href="lesson-5.html#函数的简写"><i class="fa fa-check"></i><b>5.9.4</b> 函数的简写</a></li>
<li class="chapter" data-level="5.9.5" data-path="lesson-5.html"><a href="lesson-5.html#if-条件语句"><i class="fa fa-check"></i><b>5.9.5</b> if 条件语句</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html"><i class="fa fa-check"></i><b>6</b> 第六讲：数据预处理</a>
<ul>
<li class="chapter" data-level="6.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#tidyverse"><i class="fa fa-check"></i><b>6.1</b> <strong>Tidyverse</strong></a></li>
<li class="chapter" data-level="6.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#问卷数据"><i class="fa fa-check"></i><b>6.2</b> 问卷数据</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题数据情况"><i class="fa fa-check"></i><b>6.2.1</b> 研究问题&amp;数据情况</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤完整的管道操作"><i class="fa fa-check"></i><b>6.2.2</b> 操作步骤|完整的管道操作</a></li>
<li class="chapter" data-level="6.2.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结"><i class="fa fa-check"></i><b>6.2.3</b> 小结</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#反应时数据"><i class="fa fa-check"></i><b>6.3</b> 反应时数据</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#研究问题-数据情况"><i class="fa fa-check"></i><b>6.3.1</b> 研究问题 &amp; 数据情况</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#操作步骤"><i class="fa fa-check"></i><b>6.3.2</b> 操作步骤</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六讲数据预处理.html"><a href="第六讲数据预处理.html#小结-1"><i class="fa fa-check"></i><b>6.3.3</b> 小结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html"><i class="fa fa-check"></i><b>7</b> 第七讲：描述性统计与数据可视化基础</a>
<ul>
<li class="chapter" data-level="7.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#回顾"><i class="fa fa-check"></i><b>7.1</b> 回顾</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#批量导入数据"><i class="fa fa-check"></i><b>7.1.1</b> 批量导入数据</a></li>
<li class="chapter" data-level="7.1.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#代码书写规范"><i class="fa fa-check"></i><b>7.1.2</b> 代码书写规范</a></li>
<li class="chapter" data-level="7.1.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据清洗-1"><i class="fa fa-check"></i><b>7.1.3</b> 数据清洗</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#探索性数据分析"><i class="fa fa-check"></i><b>7.2</b> 探索性数据分析</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用函数介绍"><i class="fa fa-check"></i><b>7.2.1</b> 常用函数介绍</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#数据可视化"><i class="fa fa-check"></i><b>7.3</b> 数据可视化</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的重要性"><i class="fa fa-check"></i><b>7.3.1</b> 可视化的重要性</a></li>
<li class="chapter" data-level="7.3.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#可视化的逻辑"><i class="fa fa-check"></i><b>7.3.2</b> 可视化的逻辑</a></li>
<li class="chapter" data-level="7.3.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#单个图片的组成"><i class="fa fa-check"></i><b>7.3.3</b> 单个图片的组成</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#常用图形"><i class="fa fa-check"></i><b>7.4</b> 常用图形</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图"><i class="fa fa-check"></i><b>7.4.1</b> 直方图</a></li>
<li class="chapter" data-level="7.4.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#直方图密度图"><i class="fa fa-check"></i><b>7.4.2</b> 直方图+密度图</a></li>
<li class="chapter" data-level="7.4.3" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#箱线图"><i class="fa fa-check"></i><b>7.4.3</b> 箱线图</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer"><i class="fa fa-check"></i><b>7.5</b> Data Explorer</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#data-explorer-1"><i class="fa fa-check"></i><b>7.5.1</b> Data Explorer</a></li>
<li class="chapter" data-level="7.5.2" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#使用ggpairs"><i class="fa fa-check"></i><b>7.5.2</b> 使用ggpairs</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#练习"><i class="fa fa-check"></i><b>7.6</b> 练习</a></li>
<li class="chapter" data-level="7.7" data-path="第七讲描述性统计与数据可视化基础.html"><a href="第七讲描述性统计与数据可视化基础.html#参考阅读"><i class="fa fa-check"></i><b>7.7</b> 参考阅读</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html"><i class="fa fa-check"></i><b>8</b> 第八讲：回归模型(一)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#研究问题"><i class="fa fa-check"></i><b>8.1</b> 研究问题</a></li>
<li class="chapter" data-level="8.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#t-test作为回归模型的特例"><i class="fa fa-check"></i><b>8.2</b> <em>t</em>-test作为回归模型的特例</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#独立样本t检验independent-t-test"><i class="fa fa-check"></i><b>8.2.1</b> 独立样本<em>t</em>检验(independent <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#线性回归linear-regression"><i class="fa fa-check"></i><b>8.2.2</b> 线性回归(linear regression)</a></li>
<li class="chapter" data-level="8.2.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#单样本t检验one-sample-t-test"><i class="fa fa-check"></i><b>8.2.3</b> 单样本<em>t</em>检验(one sample <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#配对样本t检验paired-t-test"><i class="fa fa-check"></i><b>8.2.4</b> 配对样本<em>t</em>检验(paired <em>t</em>-test)</a></li>
<li class="chapter" data-level="8.2.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#brucerttest"><i class="fa fa-check"></i><b>8.2.5</b> <code>bruceR::TTEST()</code></a></li>
<li class="chapter" data-level="8.2.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#总结"><i class="fa fa-check"></i><b>8.2.6</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#anova-linear-regression"><i class="fa fa-check"></i><b>8.3</b> ANOVA &amp; linear regression</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#研究问题-1"><i class="fa fa-check"></i><b>8.3.1</b> 研究问题</a></li>
<li class="chapter" data-level="8.3.2" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操-知识回顾"><i class="fa fa-check"></i><b>8.3.2</b> 代码实操 &amp; 知识回顾</a></li>
<li class="chapter" data-level="8.3.3" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#anova代码实操数据预处理"><i class="fa fa-check"></i><b>8.3.3</b> ANOVA代码实操|数据预处理</a></li>
<li class="chapter" data-level="8.3.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操正态性检验"><i class="fa fa-check"></i><b>8.3.4</b> 代码实操|正态性检验</a></li>
<li class="chapter" data-level="8.3.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操双因素被试间方差分析"><i class="fa fa-check"></i><b>8.3.5</b> 代码实操|双因素被试间方差分析</a></li>
<li class="chapter" data-level="8.3.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#代码实操平方和ss的计算"><i class="fa fa-check"></i><b>8.3.6</b> 代码实操|平方和(SS)的计算</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#线性回归"><i class="fa fa-check"></i><b>8.4</b> 线性回归</a></li>
<li class="chapter" data-level="8.5" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#知识延申单因素方差分析示例"><i class="fa fa-check"></i><b>8.5</b> 知识延申|单因素方差分析示例</a></li>
<li class="chapter" data-level="8.6" data-path="第八讲回归模型一.html"><a href="第八讲回归模型一.html#知识延申总结"><i class="fa fa-check"></i><b>8.6</b> 知识延申|总结</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html"><i class="fa fa-check"></i><b>9</b> 第九讲：回归模型(二)：分层线性模型</a>
<ul>
<li class="chapter" data-level="9.1" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#回顾-1"><i class="fa fa-check"></i><b>9.1</b> 回顾</a></li>
<li class="chapter" data-level="9.2" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#重复测量方差分析"><i class="fa fa-check"></i><b>9.2</b> 重复测量方差分析</a></li>
<li class="chapter" data-level="9.3" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#分层线性模型多层线性模型hlm"><i class="fa fa-check"></i><b>9.3</b> 分层线性模型/多层线性模型(HLM):</a></li>
<li class="chapter" data-level="9.4" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#多层线性模型的应用"><i class="fa fa-check"></i><b>9.4</b> 多层线性模型的应用</a></li>
<li class="chapter" data-level="9.5" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#hlm的应用"><i class="fa fa-check"></i><b>9.5</b> HLM的应用</a></li>
<li class="chapter" data-level="9.6" data-path="第九讲回归模型二分层线性模型.html"><a href="第九讲回归模型二分层线性模型.html#思考"><i class="fa fa-check"></i><b>9.6</b> 思考</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html"><i class="fa fa-check"></i><b>10</b> 第十讲：回归模型(三)：广义线性模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#前章回顾和本章数据预处理"><i class="fa fa-check"></i><b>10.1</b> 前章回顾和本章数据预处理</a></li>
<li class="chapter" data-level="10.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#广义线性模型"><i class="fa fa-check"></i><b>10.2</b> 广义线性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#回归方程和普通线性模型"><i class="fa fa-check"></i><b>10.2.1</b> 回归方程和普通线性模型</a></li>
<li class="chapter" data-level="10.2.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#连接函数和广义线性模型"><i class="fa fa-check"></i><b>10.2.2</b> 连接函数和广义线性模型</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#二项分布"><i class="fa fa-check"></i><b>10.3</b> 二项分布</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#伯努利实验"><i class="fa fa-check"></i><b>10.3.1</b> 伯努利实验</a></li>
<li class="chapter" data-level="10.3.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#glm代码实操"><i class="fa fa-check"></i><b>10.3.2</b> GLM代码实操</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同方法比较"><i class="fa fa-check"></i><b>10.4</b> 不同方法比较</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的建模方法"><i class="fa fa-check"></i><b>10.4.1</b> 不同的建模方法</a></li>
<li class="chapter" data-level="10.4.2" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#不同的模型比较方法"><i class="fa fa-check"></i><b>10.4.2</b> 不同的模型比较方法</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="第十讲回归模型三广义线性模型.html"><a href="第十讲回归模型三广义线性模型.html#其他分布"><i class="fa fa-check"></i><b>10.5</b> 其他分布</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html"><i class="fa fa-check"></i><b>11</b> 第十一讲：回归模型(四)：中介分析</a>
<ul>
<li class="chapter" data-level="11.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#准备工作"><i class="fa fa-check"></i><b>11.1</b> 准备工作</a></li>
<li class="chapter" data-level="11.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#线性模型回顾"><i class="fa fa-check"></i><b>11.2</b> 线性模型回顾</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#线性模型及模型检验"><i class="fa fa-check"></i><b>11.2.1</b> 线性模型及模型检验</a></li>
<li class="chapter" data-level="11.2.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#多元线性模型的局限"><i class="fa fa-check"></i><b>11.2.2</b> 多元线性模型的局限</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介分析"><i class="fa fa-check"></i><b>11.3</b> 中介分析</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#对于机制的表示图"><i class="fa fa-check"></i><b>11.3.1</b> 2.1 对于“机制”的表示——“图”</a></li>
<li class="chapter" data-level="11.3.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介分析-1"><i class="fa fa-check"></i><b>11.3.2</b> 中介分析</a></li>
<li class="chapter" data-level="11.3.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介效应"><i class="fa fa-check"></i><b>11.3.3</b> 中介效应</a></li>
<li class="chapter" data-level="11.3.4" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#中介效应的检验"><i class="fa fa-check"></i><b>11.3.4</b> 中介效应的检验</a></li>
<li class="chapter" data-level="11.3.5" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#问题提出"><i class="fa fa-check"></i><b>11.3.5</b> 问题提出</a></li>
<li class="chapter" data-level="11.3.6" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#代码实现"><i class="fa fa-check"></i><b>11.3.6</b> 代码实现</a></li>
<li class="chapter" data-level="11.3.7" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#process-in-brucer"><i class="fa fa-check"></i><b>11.3.7</b> PROCESS in bruceR()</a></li>
<li class="chapter" data-level="11.3.8" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#反思"><i class="fa fa-check"></i><b>11.3.8</b> 反思</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断"><i class="fa fa-check"></i><b>11.4</b> 因果推断</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断casual-inference"><i class="fa fa-check"></i><b>11.4.1</b> 因果推断(Casual Inference)</a></li>
<li class="chapter" data-level="11.4.2" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#因果推断与概率"><i class="fa fa-check"></i><b>11.4.2</b> 因果推断与概率</a></li>
<li class="chapter" data-level="11.4.3" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#基于实验的中介"><i class="fa fa-check"></i><b>11.4.3</b> 基于实验的中介</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#参考资料推荐"><i class="fa fa-check"></i><b>11.5</b> 参考资料推荐</a></li>
<li class="chapter" data-level="11.6" data-path="第十一讲回归模型四中介分析.html"><a href="第十一讲回归模型四中介分析.html#总结-1"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html"><i class="fa fa-check"></i><b>12</b> 第十二讲：数据可视化进阶</a>
<ul>
<li class="chapter" data-level="12.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图的必要性和作图数据处理"><i class="fa fa-check"></i><b>12.1</b> 作图的必要性和作图数据处理</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#为什么要进行可视化及可视化的原则"><i class="fa fa-check"></i><b>12.1.1</b> 为什么要进行可视化及可视化的原则</a></li>
<li class="chapter" data-level="12.1.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#作图数据准备"><i class="fa fa-check"></i><b>12.1.2</b> 作图数据准备</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#基础作图"><i class="fa fa-check"></i><b>12.2</b> 基础作图</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#ggplot2基础回顾"><i class="fa fa-check"></i><b>12.2.1</b> <code>ggplot2</code>基础回顾</a></li>
<li class="chapter" data-level="12.2.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#主要图层"><i class="fa fa-check"></i><b>12.2.2</b> 主要图层</a></li>
<li class="chapter" data-level="12.2.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可选图层"><i class="fa fa-check"></i><b>12.2.3</b> 可选图层</a></li>
<li class="chapter" data-level="12.2.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#同时呈现多张图片"><i class="fa fa-check"></i><b>12.2.4</b> 同时呈现多张图片</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#进阶作图"><i class="fa fa-check"></i><b>12.3</b> 进阶作图</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#整体和个体效应共存的图"><i class="fa fa-check"></i><b>12.3.1</b> 整体和个体效应共存的图</a></li>
<li class="chapter" data-level="12.3.2" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#可视化层级模型的random-effect"><i class="fa fa-check"></i><b>12.3.2</b> 可视化层级模型的random effect</a></li>
<li class="chapter" data-level="12.3.3" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#雨云图rain-cloud-plot"><i class="fa fa-check"></i><b>12.3.3</b> 雨云图（rain cloud plot）</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="第十二讲数据可视化进阶.html"><a href="第十二讲数据可视化进阶.html#高级图片处理-magick"><i class="fa fa-check"></i><b>12.4</b> 高级图片处理 – <code>magick</code></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html"><i class="fa fa-check"></i><b>13</b> 第十三讲：基于网络模型的心理学研究</a>
<ul>
<li class="chapter" data-level="13.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#基于潜变量的心理学研究"><i class="fa fa-check"></i><b>13.1</b> 基于潜变量的心理学研究</a></li>
<li class="chapter" data-level="13.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#潜变量模型在心理学的困境"><i class="fa fa-check"></i><b>13.2</b> 潜变量模型在心理学的困境</a></li>
<li class="chapter" data-level="13.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#基于网络的心理学视角"><i class="fa fa-check"></i><b>13.3</b> 基于网络的心理学视角</a></li>
<li class="chapter" data-level="13.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#如果寻找可观测特征的因果关系"><i class="fa fa-check"></i><b>13.4</b> 如果寻找可观测特征的因果关系</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#d-separation"><i class="fa fa-check"></i><b>13.4.1</b> d-separation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#dag贝叶斯网络"><i class="fa fa-check"></i><b>13.5</b> DAG（贝叶斯网络）</a></li>
<li class="chapter" data-level="13.6" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#高斯图模型ggm"><i class="fa fa-check"></i><b>13.6</b> 高斯图模型（GGM）</a></li>
<li class="chapter" data-level="13.7" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#易辛模型ising-model"><i class="fa fa-check"></i><b>13.7</b> 易辛模型Ising model</a></li>
<li class="chapter" data-level="13.8" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#心理网络的估计"><i class="fa fa-check"></i><b>13.8</b> 心理网络的估计</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#高斯图模型"><i class="fa fa-check"></i><b>13.8.1</b> 高斯图模型</a></li>
<li class="chapter" data-level="13.8.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#多元估计"><i class="fa fa-check"></i><b>13.8.2</b> 多元估计</a></li>
<li class="chapter" data-level="13.8.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#一元估计"><i class="fa fa-check"></i><b>13.8.3</b> 一元估计</a></li>
<li class="chapter" data-level="13.8.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-1"><i class="fa fa-check"></i><b>13.8.4</b> 代码实现</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#模型选择"><i class="fa fa-check"></i><b>13.9</b> 模型选择</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#模型选择的方式"><i class="fa fa-check"></i><b>13.9.1</b> 模型选择的方式</a></li>
<li class="chapter" data-level="13.9.2" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-2"><i class="fa fa-check"></i><b>13.9.2</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.3" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-3"><i class="fa fa-check"></i><b>13.9.3</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.4" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#代码实现-4"><i class="fa fa-check"></i><b>13.9.4</b> 代码实现</a></li>
<li class="chapter" data-level="13.9.5" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#总结-2"><i class="fa fa-check"></i><b>13.9.5</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#心理网络的挑战"><i class="fa fa-check"></i><b>13.10</b> 心理网络的挑战</a></li>
<li class="chapter" data-level="13.11" data-path="第十三讲基于网络模型的心理学研究.html"><a href="第十三讲基于网络模型的心理学研究.html#我们是否还需要潜变量模型"><i class="fa fa-check"></i><b>13.11</b> 我们是否还需要潜变量模型</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html"><i class="fa fa-check"></i><b>14</b> 第十四讲：心理学元分析入门</a>
<ul>
<li class="chapter" data-level="14.1" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#什么是元分析"><i class="fa fa-check"></i><b>14.1</b> 什么是元分析</a></li>
<li class="chapter" data-level="14.2" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#元分析的实施"><i class="fa fa-check"></i><b>14.2</b> 元分析的实施</a></li>
<li class="chapter" data-level="14.3" data-path="第十四讲心理学元分析入门.html"><a href="第十四讲心理学元分析入门.html#回顾与总结"><i class="fa fa-check"></i><b>14.3</b> 回顾与总结</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html"><i class="fa fa-check"></i><b>15</b> 补充1：如何进行基本的数据分析: 相关与回归</a>
<ul>
<li class="chapter" data-level="15.1" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#什么是相关"><i class="fa fa-check"></i><b>15.1</b> 什么是相关</a></li>
<li class="chapter" data-level="15.2" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#相关-代码实现"><i class="fa fa-check"></i><b>15.2</b> 相关-代码实现</a></li>
<li class="chapter" data-level="15.3" data-path="补充1如何进行基本的数据分析-相关与回归.html"><a href="补充1如何进行基本的数据分析-相关与回归.html#什么是回归"><i class="fa fa-check"></i><b>15.3</b> 什么是回归</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html"><i class="fa fa-check"></i><b>16</b> 补充2：从分析到手稿</a>
<ul>
<li class="chapter" data-level="16.1" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#通过papaja撰写论文"><i class="fa fa-check"></i><b>16.1</b> <strong>通过Papaja撰写论文</strong></a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part1-papaja包的安装"><i class="fa fa-check"></i><b>16.1.1</b> <strong>Part1: Papaja包的安装</strong></a></li>
<li class="chapter" data-level="16.1.2" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part2-papaja语法格式"><i class="fa fa-check"></i><b>16.1.2</b> <strong>Part2: Papaja语法格式</strong></a></li>
<li class="chapter" data-level="16.1.3" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#part3-正文的撰写"><i class="fa fa-check"></i><b>16.1.3</b> <strong>Part3: 正文的撰写</strong></a></li>
<li class="chapter" data-level="16.1.4" data-path="补充2从分析到手稿.html"><a href="补充2从分析到手稿.html#总结-3"><i class="fa fa-check"></i><b>16.1.4</b> 总结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html"><i class="fa fa-check"></i><b>17</b> 补充3：效应量和元分析</a>
<ul>
<li class="chapter" data-level="17.1" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#效应量简介"><i class="fa fa-check"></i><b>17.1</b> 效应量简介</a></li>
<li class="chapter" data-level="17.2" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#算法实现"><i class="fa fa-check"></i><b>17.2</b> 算法实现</a></li>
<li class="chapter" data-level="17.3" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#小练习"><i class="fa fa-check"></i><b>17.3</b> 小练习</a></li>
<li class="chapter" data-level="17.4" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#元分析简介"><i class="fa fa-check"></i><b>17.4</b> 元分析简介</a></li>
<li class="chapter" data-level="17.5" data-path="补充3效应量和元分析.html"><a href="补充3效应量和元分析.html#元分析实现"><i class="fa fa-check"></i><b>17.5</b> 元分析实现</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言在心理学研究中的应用: 从原始数据到可重复的论文手稿(V2)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第十二讲数据可视化进阶" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> 第十二讲：数据可视化进阶<a href="第十二讲数据可视化进阶.html#第十二讲数据可视化进阶" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="作图的必要性和作图数据处理" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> 作图的必要性和作图数据处理<a href="第十二讲数据可视化进阶.html#作图的必要性和作图数据处理" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>我们在前两章对心理学和社会科学中最常用的回归模型进行了讲解。在数据分析的过程中，最关键的并不是如何用R代码，而是如何<strong>正确地使用</strong>R代码。这就意味着我们要去学习代码其背后的统计知识，所以我们前面对回归模型进行了讲解。当我们分析完数据并且有适当的知道解读结果时，我们可能希望将结果以一种美观的方式呈现给读者，向读者传达我们解读出的有价值的信息。这里需要对数据进行进一步的可视化。</p>
<p>前面章节也讲到过可视化，当时主要的目的是对数据进行初步的探索，让我们可以快速地辨别和发现数据之间的一些关系，帮助我们快速地了解数据。但这里本章要讲的数据可视化，是针对如何得到一个<strong>可发表</strong>的图。</p>
<div id="为什么要进行可视化及可视化的原则" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> 为什么要进行可视化及可视化的原则<a href="第十二讲数据可视化进阶.html#为什么要进行可视化及可视化的原则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>经常读论文的朋友可能会发现，读了许多篇论文后，我们会形成一个习惯——先看标题，然后看摘要，接着就开始看文章的图表。为什么会形成这样的顺序呢？这是因为科学论文中，图表在很多情况是用于展示最关键的信息。好的数据可视化可以做到”一图胜千言”。但要画出一张漂亮且直观的图片，需要经过许多思考的。</p>
<p>在R中我们仍然用<code>ggplot2</code>这个包进行画图。如何画好一张图呢？</p>
<p>首先，要清楚的是：想要通过可视化达到什么样的目的。例如，在心理学实验研究中，方法部分的流程图和结果部分的统计结果图，目标肯定是不一样的。从这个角度讲，我们不仅要知道作图的技术，还要灵活地通过可视化来更好地传达自己想要表达的“意”。</p>
<p>其次，我们也需要大致知道好的可视化的标准。这里我将可视化的标准与翻译进行类比，认知好的可视化需要做到<strong>信</strong>、<strong>达</strong>、<strong>雅</strong>三个标准。<strong>信</strong>，是指可视化要传递足够的信息量。如果读者经常看顶刊的文章会发现，顶刊上图片的信息量越来越大，尤其在生物医药领域，一个图通常包含非常多的子图，每一个子图又包含了不少的元素。当然这并不一定是推荐的方式，信息量应该均衡，让人能一眼可以看出表达信息。<strong>达</strong>，是指图的逻辑性，图片的线条、图例等要有层次感，让人可以清晰<em>看到</em>到元素之间的内在联系。<strong>雅</strong>，是指要追求美观。对比一下普通期刊和<em>Science</em>、<em>Nature</em>这些顶刊上的图片，会发现顶刊上的图片普遍更美观。国内也有一本图片很美观的期刊<em>The Innovation</em>，其编辑部有专门的美工对图片色彩进行打磨，这也充分体现出图片美观的重要性。</p>
<p>当然这里仅将这些原则罗列给诸位，要做出好看的图，需要不断地打磨和在实践中不断提升自己的作图技巧。</p>
</div>
<div id="作图数据准备" class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> 作图数据准备<a href="第十二讲数据可视化进阶.html#作图数据准备" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们先来导入本章所要用到的包。</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="第十二讲数据可视化进阶.html#cb457-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&#39;pacman&#39;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb457-2"><a href="第十二讲数据可视化进阶.html#cb457-2" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&#39;pacman&#39;</span>)</span>
<span id="cb457-3"><a href="第十二讲数据可视化进阶.html#cb457-3" tabindex="-1"></a>}</span>
<span id="cb457-4"><a href="第十二讲数据可视化进阶.html#cb457-4" tabindex="-1"></a></span>
<span id="cb457-5"><a href="第十二讲数据可视化进阶.html#cb457-5" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb457-6"><a href="第十二讲数据可视化进阶.html#cb457-6" tabindex="-1"></a>  <span class="co"># 本节课需要用到的 packages</span></span>
<span id="cb457-7"><a href="第十二讲数据可视化进阶.html#cb457-7" tabindex="-1"></a>  here, tidyverse, reshape, bruceR, ggplot2, patchwork, magick, ggdist)</span>
<span id="cb457-8"><a href="第十二讲数据可视化进阶.html#cb457-8" tabindex="-1"></a></span>
<span id="cb457-9"><a href="第十二讲数据可视化进阶.html#cb457-9" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">99999</span>,<span class="at">digits =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>数据仍然是之前所用到的认知实验的数据。这里为了方便，我们仅选取了“match”条件下的数据。我们之前发现“Valence”和“Identity”之间有显著的交互作用。作图开始时，我们可能首先会想到的这意味着两条交叉的线，两条线的端点分别是各个条件下的均值。因此我们需要先得到各个条件下面的均值。</p>
<p>首先这是实验中每个试次的数据。</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="第十二讲数据可视化进阶.html#cb458-1" tabindex="-1"></a>df.match.trial <span class="ot">&lt;-</span> bruceR<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Book&quot;</span>,<span class="st">&#39;data&#39;</span>,<span class="st">&#39;match&#39;</span>,<span class="st">&#39;match_raw.csv&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb458-2"><a href="第十二讲数据可视化进阶.html#cb458-2" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">extract</span>(Shape, </span>
<span id="cb458-3"><a href="第十二讲数据可视化进阶.html#cb458-3" tabindex="-1"></a>                 <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&#39;Valence&#39;</span>, <span class="st">&#39;Identity&#39;</span>),</span>
<span id="cb458-4"><a href="第十二讲数据可视化进阶.html#cb458-4" tabindex="-1"></a>                 <span class="at">regex =</span> <span class="st">&#39;(moral|immoral)(Self|Other)&#39;</span>,</span>
<span id="cb458-5"><a href="第十二讲数据可视化进阶.html#cb458-5" tabindex="-1"></a>                 <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co">#将Shape列分为两列</span></span>
<span id="cb458-6"><a href="第十二讲数据可视化进阶.html#cb458-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Valence =</span> <span class="fu">factor</span>(Valence, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;moral&#39;</span>,<span class="st">&#39;immoral&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;moral&#39;</span>,<span class="st">&#39;immoral&#39;</span>)),</span>
<span id="cb458-7"><a href="第十二讲数据可视化进阶.html#cb458-7" tabindex="-1"></a>                <span class="at">Identity =</span> <span class="fu">factor</span>(Identity, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Self&#39;</span>,<span class="st">&#39;Other&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Self&#39;</span>,<span class="st">&#39;Other&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb458-8"><a href="第十二讲数据可视化进阶.html#cb458-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ACC <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> ACC <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb458-9"><a href="第十二讲数据可视化进阶.html#cb458-9" tabindex="-1"></a>                RT <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> RT <span class="sc">&lt;=</span> <span class="fl">1.5</span>,</span>
<span id="cb458-10"><a href="第十二讲数据可视化进阶.html#cb458-10" tabindex="-1"></a>                Match <span class="sc">==</span> <span class="st">&#39;match&#39;</span>,</span>
<span id="cb458-11"><a href="第十二讲数据可视化进阶.html#cb458-11" tabindex="-1"></a>                (<span class="sc">!</span>Sub <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7302</span>,<span class="dv">7303</span>,<span class="dv">7338</span>))) </span>
<span id="cb458-12"><a href="第十二讲数据可视化进阶.html#cb458-12" tabindex="-1"></a></span>
<span id="cb458-13"><a href="第十二讲数据可视化进阶.html#cb458-13" tabindex="-1"></a><span class="fu">head</span>(df.match.trial, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-53c1f045b57709848dd3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-53c1f045b57709848dd3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["06-May-2018_14:45:42","06-May-2018_14:45:44","06-May-2018_14:45:50","06-May-2018_14:45:53"],["Exp","Exp","Exp","Exp"],[7304,7304,7304,7304],[25,25,25,25],["female","female","female","female"],["R","R","R","R"],[1,1,1,1],[1,1,1,1],[3,4,7,8],["moralOther","immoralOther","moralSelf","immoralOther"],["moral","immoral","moral","immoral"],["Other","Other","Self","Other"],["moralOther","immoralOther","moralSelf","immoralOther"],["match","match","match","match"],["n","n","n","n"],["n","m","n","m"],[1,0,1,0],[0.8167,0.8728,0.4951,0.8713]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date<\/th>\n      <th>Prac<\/th>\n      <th>Sub<\/th>\n      <th>Age<\/th>\n      <th>Sex<\/th>\n      <th>Hand<\/th>\n      <th>Block<\/th>\n      <th>Bin<\/th>\n      <th>Trial<\/th>\n      <th>Shape<\/th>\n      <th>Valence<\/th>\n      <th>Identity<\/th>\n      <th>Label<\/th>\n      <th>Match<\/th>\n      <th>CorrResp<\/th>\n      <th>Resp<\/th>\n      <th>ACC<\/th>\n      <th>RT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,7,8,9,17,18]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Date","targets":1},{"name":"Prac","targets":2},{"name":"Sub","targets":3},{"name":"Age","targets":4},{"name":"Sex","targets":5},{"name":"Hand","targets":6},{"name":"Block","targets":7},{"name":"Bin","targets":8},{"name":"Trial","targets":9},{"name":"Shape","targets":10},{"name":"Valence","targets":11},{"name":"Identity","targets":12},{"name":"Label","targets":13},{"name":"Match","targets":14},{"name":"CorrResp","targets":15},{"name":"Resp","targets":16},{"name":"ACC","targets":17},{"name":"RT","targets":18}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>接下来我们整合试次，得到每个被试在4中条件下的均值。</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="第十二讲数据可视化进阶.html#cb459-1" tabindex="-1"></a>df.match.subj <span class="ot">&lt;-</span> df.match.trial <span class="sc">%&gt;%</span></span>
<span id="cb459-2"><a href="第十二讲数据可视化进阶.html#cb459-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Sub, Identity, Valence) <span class="sc">%&gt;%</span></span>
<span id="cb459-3"><a href="第十二讲数据可视化进阶.html#cb459-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">RT_mean =</span> <span class="fu">mean</span>(RT), </span>
<span id="cb459-4"><a href="第十二讲数据可视化进阶.html#cb459-4" tabindex="-1"></a>                   <span class="at">ACC_mean =</span> <span class="fu">mean</span>(ACC)) <span class="sc">%&gt;%</span></span>
<span id="cb459-5"><a href="第十二讲数据可视化进阶.html#cb459-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Sub&#39;, &#39;Identity&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="第十二讲数据可视化进阶.html#cb461-1" tabindex="-1"></a><span class="fu">head</span>(df.match.subj, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2e3eaaf697c32d5c8a2a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e3eaaf697c32d5c8a2a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],[7304,7304,7304,7304],["Self","Self","Other","Other"],["moral","immoral","moral","immoral"],[0.552276,0.706672602739726,0.7493875,0.7581492957746478],[0.9866666666666667,0.821917808219178,0.8333333333333334,0.7183098591549296]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sub<\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>RT_mean<\/th>\n      <th>ACC_mean<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Sub","targets":1},{"name":"Identity","targets":2},{"name":"Valence","targets":3},{"name":"RT_mean","targets":4},{"name":"ACC_mean","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>因为我们在作图时想看到的是总体的交互作用，因此我们将所有被试的数据平均得到一个总体在4种条件下的RT和ACC均值。在下面的代码中，大家可以发现SD和SE，这是因为我们在作图时还需要在均值的基础上加上误差棒（error
bar）。这里我们需要将误差棒和字母”T”进行区分。因为之前有个研究者拿字母”T”冒充误差棒，当然后来被人发现了，还在社交媒体上火了一把。这也提示我们作图时，拿最基础的柱图举例，不仅要画出集中趋势（平均值），还要画出离散趋势（误差项）。</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="第十二讲数据可视化进阶.html#cb462-1" tabindex="-1"></a>df.match.sum <span class="ot">&lt;-</span> df.match.subj <span class="sc">%&gt;%</span> </span>
<span id="cb462-2"><a href="第十二讲数据可视化进阶.html#cb462-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Identity, Valence) <span class="sc">%&gt;%</span></span>
<span id="cb462-3"><a href="第十二讲数据可视化进阶.html#cb462-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">grand_mean_RT =</span> <span class="fu">mean</span>(RT_mean),</span>
<span id="cb462-4"><a href="第十二讲数据可视化进阶.html#cb462-4" tabindex="-1"></a>                   <span class="at">SD_RT =</span> <span class="fu">sd</span>(RT_mean),</span>
<span id="cb462-5"><a href="第十二讲数据可视化进阶.html#cb462-5" tabindex="-1"></a>                   <span class="at">SE_RT =</span> SD_RT<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb462-6"><a href="第十二讲数据可视化进阶.html#cb462-6" tabindex="-1"></a>                   <span class="at">grand_mean_ACC =</span> <span class="fu">mean</span>(ACC_mean),</span>
<span id="cb462-7"><a href="第十二讲数据可视化进阶.html#cb462-7" tabindex="-1"></a>                   <span class="at">SD_ACC =</span> <span class="fu">sd</span>(ACC_mean),</span>
<span id="cb462-8"><a href="第十二讲数据可视化进阶.html#cb462-8" tabindex="-1"></a>                   <span class="at">SE_ACC =</span> SD_ACC<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb462-9"><a href="第十二讲数据可视化进阶.html#cb462-9" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb462-10"><a href="第十二讲数据可视化进阶.html#cb462-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Identity&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="第十二讲数据可视化进阶.html#cb464-1" tabindex="-1"></a><span class="fu">head</span>(df.match.sum, <span class="dv">4</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-33f5a6c1c7195c56d74d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-33f5a6c1c7195c56d74d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["Self","Self","Other","Other"],["moral","immoral","moral","immoral"],[0.6366372764212784,0.7150271256631987,0.6850132435574973,0.6996564845828235],[0.06334254097700114,0.06957103122069196,0.07816459938618592,0.06950417219585882],[0.01001533511349354,0.01100014589120355,0.01235890832274734,0.01098957455117303],[0.9161836748531289,0.8142527831854576,0.8440248488102073,0.828686850170307],[0.09801447927048731,0.1197130892135965,0.1095526473381531,0.1107136186340657],[0.01549744990850494,0.01892830138249502,0.01732179446448731,0.01750536014414538],[41,41,41,41]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>grand_mean_RT<\/th>\n      <th>SD_RT<\/th>\n      <th>SE_RT<\/th>\n      <th>grand_mean_ACC<\/th>\n      <th>SD_ACC<\/th>\n      <th>SE_ACC<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Identity","targets":1},{"name":"Valence","targets":2},{"name":"grand_mean_RT","targets":3},{"name":"SD_RT","targets":4},{"name":"SE_RT","targets":5},{"name":"grand_mean_ACC","targets":6},{"name":"SD_ACC","targets":7},{"name":"SE_ACC","targets":8},{"name":"n","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>整体的均值加上误差，这样的图在传统意义上已经足够了。但是最近几年，大家发现如果只呈现总体趋势，对读者是有误导性的。如果我们呈现每个被试数据的话，读者会发现，整体的效应量实际上没有那么大。因此最近整体的趋势是鼓励大家在作图时不仅要可视化整体数据，还要将每个个体的数据也呈现在图上。这样能够保证读者在读图时不会过高地估计实验的效应量。</p>
</div>
</div>
<div id="基础作图" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> 基础作图<a href="第十二讲数据可视化进阶.html#基础作图" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ggplot2基础回顾" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> <code>ggplot2</code>基础回顾<a href="第十二讲数据可视化进阶.html#ggplot2基础回顾" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们再来回顾一下<code>ggplot2</code>的一些基础知识，gg的全称是grammar of graphics，即作图的语法。</p>
<p><img src="pic/chp12/ggplot.png" /></p>
<p><code>ggplot2</code>的基本原理就是图层的叠加，这和Photoshop的逻辑是很类似的。</p>
<p><img src="pic/chp12/gramma.png" /></p>
<p><code>ggplot2</code>的图层叠加主要分为分为主要图层和可选图层。主要图层主要包含了数据（<code>data</code>），映射（<code>aesthetics</code>）和图形（<code>geometries</code>）。在代码中，便是如下图所示的，首先放入数据data，然后我们需要对数据建立空间上的映射(MAPPINGS)，最后再决定用什么样的几何图形对映射的数据进行可视化，也就是图中红色的部分，这些红色的图形又通过加号进行叠加。这就是基础的主要图层。</p>
<p><img src="pic/chp12/required.png" /></p>
</div>
<div id="主要图层" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> 主要图层<a href="第十二讲数据可视化进阶.html#主要图层" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们先用总体的数据来绘制主要图层。在下面的代码中，我们放入了总体数据<code>df.match.sum</code>；接着将x轴定义为”Identity”，它有两个取值”self”和”other”，y轴定义为总体的反应时；填充<code>fill</code>指的是我们所用的图例，我们将不同的Identity的柱子用Valence进行填充；最后我们用<code>geom_bar()</code>这一函数来定义所要画的是柱状图，再加上误差棒<code>geom_errorbar()</code>。这样就做出了一个2×2的条形图。</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="第十二讲数据可视化进阶.html#cb465-1" tabindex="-1"></a><span class="co"># 以柱状图为例</span></span>
<span id="cb465-2"><a href="第十二讲数据可视化进阶.html#cb465-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df.match.sum, <span class="fu">aes</span>(<span class="at">x =</span> Identity, <span class="at">y =</span> grand_mean_RT, <span class="at">fill =</span> Valence)) <span class="sc">+</span></span>
<span id="cb465-3"><a href="第十二讲数据可视化进阶.html#cb465-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;Identity&quot;</span>,</span>
<span id="cb465-4"><a href="第十二讲数据可视化进阶.html#cb465-4" tabindex="-1"></a>                    <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb465-5"><a href="第十二讲数据可视化进阶.html#cb465-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="at">data =</span> df.match.sum,</span>
<span id="cb465-6"><a href="第十二讲数据可视化进阶.html#cb465-6" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">ymin =</span> grand_mean_RT <span class="sc">-</span> SE_RT, <span class="at">ymax =</span> grand_mean_RT <span class="sc">+</span> SE_RT),</span>
<span id="cb465-7"><a href="第十二讲数据可视化进阶.html#cb465-7" tabindex="-1"></a>                         <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb465-8"><a href="第十二讲数据可视化进阶.html#cb465-8" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>))</span>
<span id="cb465-9"><a href="第十二讲数据可视化进阶.html#cb465-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>值得注意的是，<code>geom_errorbar()</code>中我们映射的是y的最大值/最小值是整体RT加上/减去SE，所以误差棒表示的是均值上下各一个标准误，虽然大部分情况下研究者都用标准误来作为误差棒，但也有会用标准差SD来作为误差棒的。另外，我们可以用width定义误差棒的宽度，<code>position_dodge()</code>将误差棒进行小幅度错开，这也对应了前面柱状图里面<code>position = "dodge"</code>。</p>
</div>
<div id="可选图层" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> 可选图层<a href="第十二讲数据可视化进阶.html#可选图层" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>上面所绘制的图其实不太符合心理学中APA的格式要求。R默认绘制出来的图有一些缺点：比如背景有阴影和框线、y轴不是以0为起点、轴的字体不是特别突出。另外我们可以看到<code>ggplot2</code>的默认字体是很小的，这也是很多研究者吐槽的一点，如果不对字体进行调节是比较影响作图的直观性的。</p>
<p>这些问题需要我们加入额外的图层来加以解决，这就是可选图层。例如我们可以用<code>scale_xxx()</code>函数自定义坐标轴的一些信息,用<code>theme_xxx()</code>函数来切换图片的主题。</p>
<p><img src="pic/chp12/adjust.png" /></p>
<p>这里我们直接在主要图层p1的基础上累加可选图层。下面的代码中，<code>expand=c(0,0)</code>让坐标原点从零点开始；<code>breaks = seq(0, 0.75, 0.25)</code>使得<code>y</code>轴以<code>0</code>开始，<code>0.75</code>结束，以<code>0.25</code>作为最小单位；<code>limits = c(0, 0.75)</code>则限定了<code>y</code>轴的范围，这些都通过<code>scale_y_continuous()</code>这一函数来进行调节，这是因为RT是连续变量，所以对应的是”continuous”。labs()用于修改主题和y坐标轴的标题。最后我们使用<code>papaja</code>包下的<code>theme_apa()</code>函数让图片自动符合APA主题。</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="第十二讲数据可视化进阶.html#cb466-1" tabindex="-1"></a><span class="co"># 以柱状图为例</span></span>
<span id="cb466-2"><a href="第十二讲数据可视化进阶.html#cb466-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span></span>
<span id="cb466-3"><a href="第十二讲数据可视化进阶.html#cb466-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb466-4"><a href="第十二讲数据可视化进阶.html#cb466-4" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.75</span>, <span class="fl">0.25</span>), </span>
<span id="cb466-5"><a href="第十二讲数据可视化进阶.html#cb466-5" tabindex="-1"></a>                              <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb466-6"><a href="第十二讲数据可视化进阶.html#cb466-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean RT for match trials&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RT&quot;</span>) <span class="sc">+</span></span>
<span id="cb466-7"><a href="第十二讲数据可视化进阶.html#cb466-7" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span>
<span id="cb466-8"><a href="第十二讲数据可视化进阶.html#cb466-8" tabindex="-1"></a></span>
<span id="cb466-9"><a href="第十二讲数据可视化进阶.html#cb466-9" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-268-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这里绘制的图整体是符合APA格式的，它以零点作为起点，没有背景的灰色和框线。同理，我们将主要图层和可选图层全部写在一起，可以得到ACC的图。</p>
<p><img src="_main_files/figure-html/unnamed-chunk-269-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="同时呈现多张图片" class="section level3 hasAnchor" number="12.2.4">
<h3><span class="header-section-number">12.2.4</span> 同时呈现多张图片<a href="第十二讲数据可视化进阶.html#同时呈现多张图片" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>现在我们有了两张图，一张RT，一张ACC，我们希望让这两张图一起呈现，那么我们应该如何将二者拼在一起呢？这里我们将介绍两种方法。</p>
<p>第一种方法是分面(<code>Facet</code>)，我们可以把画框当作一个面板，只要我们在数据框里面有分类的变量作为依据，就可以据此将不同的图片绘制在面板上。Facet也可以被认为是图层的一种，也是通过”+“加号叠加在原始图片上，可以分为一维(<code>facet_wrap</code>)和二维(<code>facet_grid</code>)两种，下图所示为二维，由于不同的子图之间有很多变量是相同的，这样陈列在一起方便我们进行肉眼上的比较和观察。</p>
<p><img src="pic/chp12/facet.png" /></p>
<p>在我们的数据中，RT和ACC在x轴上的变量是一致的，但是y轴的因变量是不同的，因此我们需要一个额外的变量去对RT和ACC进行分类和标记，然后R才能根据这个不同的标记进行分面板的绘制和呈现。这听起来有点复杂，实际上就是意味着我们在呈现数据的时候要合并RT和ACC。在下面的代码中，我们将之前的”grand_mean_RT”和”grand_mean_ACC”全部重新命名为grand_mean，SD和SE也进行类似的操作，合并完后我们再新增一个叫做DV的变量对RT和ACC进行分类。</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="第十二讲数据可视化进阶.html#cb467-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df.match.sum[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb467-2"><a href="第十二讲数据可视化进阶.html#cb467-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">grand_mean =</span> grand_mean_RT,</span>
<span id="cb467-3"><a href="第十二讲数据可视化进阶.html#cb467-3" tabindex="-1"></a>                <span class="at">SD =</span> SD_RT,</span>
<span id="cb467-4"><a href="第十二讲数据可视化进阶.html#cb467-4" tabindex="-1"></a>                <span class="at">SE =</span> SE_RT) <span class="sc">%&gt;%</span></span>
<span id="cb467-5"><a href="第十二讲数据可视化进阶.html#cb467-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> <span class="st">&quot;RT&quot;</span>)</span>
<span id="cb467-6"><a href="第十二讲数据可视化进阶.html#cb467-6" tabindex="-1"></a></span>
<span id="cb467-7"><a href="第十二讲数据可视化进阶.html#cb467-7" tabindex="-1"></a>df.match.sum.long <span class="ot">&lt;-</span> df.match.sum[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb467-8"><a href="第十二讲数据可视化进阶.html#cb467-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">grand_mean =</span> grand_mean_ACC,</span>
<span id="cb467-9"><a href="第十二讲数据可视化进阶.html#cb467-9" tabindex="-1"></a>                <span class="at">SD =</span> SD_ACC,</span>
<span id="cb467-10"><a href="第十二讲数据可视化进阶.html#cb467-10" tabindex="-1"></a>                <span class="at">SE =</span> SE_ACC) <span class="sc">%&gt;%</span></span>
<span id="cb467-11"><a href="第十二讲数据可视化进阶.html#cb467-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> <span class="st">&quot;ACC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb467-12"><a href="第十二讲数据可视化进阶.html#cb467-12" tabindex="-1"></a>  <span class="fu">rbind</span>(df1,.)</span>
<span id="cb467-13"><a href="第十二讲数据可视化进阶.html#cb467-13" tabindex="-1"></a></span>
<span id="cb467-14"><a href="第十二讲数据可视化进阶.html#cb467-14" tabindex="-1"></a><span class="fu">rm</span>(df1)</span>
<span id="cb467-15"><a href="第十二讲数据可视化进阶.html#cb467-15" tabindex="-1"></a></span>
<span id="cb467-16"><a href="第十二讲数据可视化进阶.html#cb467-16" tabindex="-1"></a><span class="fu">head</span>(df.match.sum.long, <span class="dv">3</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cb0fdf83e66a73688c78" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cb0fdf83e66a73688c78">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Self","Self","Other"],["moral","immoral","moral"],[0.6366372764212784,0.7150271256631987,0.6850132435574973],[0.06334254097700114,0.06957103122069196,0.07816459938618592],[0.01001533511349354,0.01100014589120355,0.01235890832274734],[41,41,41],["RT","RT","RT"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Identity<\/th>\n      <th>Valence<\/th>\n      <th>grand_mean<\/th>\n      <th>SD<\/th>\n      <th>SE<\/th>\n      <th>n<\/th>\n      <th>DV<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Identity","targets":1},{"name":"Valence","targets":2},{"name":"grand_mean","targets":3},{"name":"SD","targets":4},{"name":"SE","targets":5},{"name":"n","targets":6},{"name":"DV","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>此时，我们的数据框就变成了一个长形的数据，并使用DV这一列对数据因变量进行分类。合并与分类结束之后，我们就可以使用<code>facet</code>来进行呈现了。在下面的代码中，<code>papaja::theme_apa()</code>这一行之前其实和前面提到的代码是一致的，只是将y定义为合并之后的因变量grand_mean。这时我们需要新增的就是放入DV这一分类变量，<code>scales = "free_y"</code>表示在不同面板上y轴的单位不固定，根据数据情况来自动调整。最后根据实际情况增加一些title和轴上的label。</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="第十二讲数据可视化进阶.html#cb468-1" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> df.match.sum.long <span class="sc">%&gt;%</span></span>
<span id="cb468-2"><a href="第十二讲数据可视化进阶.html#cb468-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., </span>
<span id="cb468-3"><a href="第十二讲数据可视化进阶.html#cb468-3" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb468-4"><a href="第十二讲数据可视化进阶.html#cb468-4" tabindex="-1"></a>                      <span class="at">y =</span> grand_mean,</span>
<span id="cb468-5"><a href="第十二讲数据可视化进阶.html#cb468-5" tabindex="-1"></a>                      <span class="at">fill =</span> Valence)) <span class="sc">+</span> </span>
<span id="cb468-6"><a href="第十二讲数据可视化进阶.html#cb468-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb468-7"><a href="第十二讲数据可视化进阶.html#cb468-7" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_dodge</span>(),</span>
<span id="cb468-8"><a href="第十二讲数据可视化进阶.html#cb468-8" tabindex="-1"></a>                    ) <span class="sc">+</span></span>
<span id="cb468-9"><a href="第十二讲数据可视化进阶.html#cb468-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> grand_mean<span class="fl">-1.96</span><span class="sc">*</span>SE,</span>
<span id="cb468-10"><a href="第十二讲数据可视化进阶.html#cb468-10" tabindex="-1"></a>                             <span class="at">ymax =</span> grand_mean<span class="fl">+1.96</span><span class="sc">*</span>SE),</span>
<span id="cb468-11"><a href="第十二讲数据可视化进阶.html#cb468-11" tabindex="-1"></a>                         <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb468-12"><a href="第十二讲数据可视化进阶.html#cb468-12" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb468-13"><a href="第十二讲数据可视化进阶.html#cb468-13" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>() <span class="sc">+</span></span>
<span id="cb468-14"><a href="第十二讲数据可视化进阶.html#cb468-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>DV, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb468-15"><a href="第十二讲数据可视化进阶.html#cb468-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Summary data for matching trials&quot;</span>,</span>
<span id="cb468-16"><a href="第十二讲数据可视化进阶.html#cb468-16" tabindex="-1"></a>                <span class="at">x=</span><span class="st">&quot;Identity&quot;</span>,</span>
<span id="cb468-17"><a href="第十二讲数据可视化进阶.html#cb468-17" tabindex="-1"></a>                <span class="at">y=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb468-18"><a href="第十二讲数据可视化进阶.html#cb468-18" tabindex="-1"></a></span>
<span id="cb468-19"><a href="第十二讲数据可视化进阶.html#cb468-19" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-271-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到合并后的图片如上图所示，共享一个y轴标签”mean”。可以看到因为没有使用<code>scale_y_continuous()</code>函数对y轴进行调整，因此这里y轴的起点并不是0，读者可以参照上面的代码来完善这幅合并之后的图。</p>
<p>第二种方法是使用<code>patchwork</code>。这种方法比较简单粗暴，不需要进行数据预处理，直接+在一起就可以，<code>plot_layout(guides = "collect")</code>指将图例合并起来。</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="第十二讲数据可视化进阶.html#cb469-1" tabindex="-1"></a>p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-272-1.png" width="85%" style="display: block; margin: auto;" /></p>
<p>我们在图上可以观察出交互作用，红色柱子相连的话，其斜率是比绿色柱子相连的斜率更大的，也就是二者会相交。如果我们将y轴的范围缩短一些，这种交互作用的趋势将会在图上更显著地呈现出来。</p>
<p>以上所讲的这些总结起来包括了数据处理和图形美化这两部分，如下图所示（注：本图来自《R语言数据可视化之美：专业图表绘制指南》）。</p>
<p><img src="pic/chp12/summary.png" /></p>
</div>
</div>
<div id="进阶作图" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> 进阶作图<a href="第十二讲数据可视化进阶.html#进阶作图" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="整体和个体效应共存的图" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> 整体和个体效应共存的图<a href="第十二讲数据可视化进阶.html#整体和个体效应共存的图" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>刚才我们提到了研究者还希望呈现除了整体之外的被试个体的数据，这就意味着要去了解更多关于图层叠加的特点和技巧。比如我们想要得到下面这样效果的图，我们将之前的柱状图改成线的方式进行呈现，可以明显看到交互作用的存在；另外还将每一个被试的数据也放在了图上，以RT图中self的条件下为例，可以看到大部分被试跟整体趋势是一致的，也就是moral下面反应时比immoral更短，然而也有几名反过来的被试。这样就把群体水平和个体水平的信息很好地呈现在一幅图上了。那么如何做出这样的图呢？</p>
<p><img src="pic/chp12/target1.png" /></p>
<p>首先我们要画出整体的均值，映射上和刚才所做的一致，图形的选择上，我们将柱状图<code>geom_bar()</code>替换为线图<code>geom_line()</code>，并用<code>geom_point()</code>将线的两端变成两个较大的点，并使用<code>position_dodge(0.5)</code>将点和线都错开一些并且互相对齐。同样的，我们加上error bar和修改y轴的坐标。值得注意的是，这里y轴的选取相比前面要更广，因为希望将所有被试的数据都纳入进来。以下是整体数据的线图代码。</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="第十二讲数据可视化进阶.html#cb470-1" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> df.match.sum <span class="sc">%&gt;%</span></span>
<span id="cb470-2"><a href="第十二讲数据可视化进阶.html#cb470-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., </span>
<span id="cb470-3"><a href="第十二讲数据可视化进阶.html#cb470-3" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb470-4"><a href="第十二讲数据可视化进阶.html#cb470-4" tabindex="-1"></a>                      <span class="at">y =</span> grand_mean_RT,</span>
<span id="cb470-5"><a href="第十二讲数据可视化进阶.html#cb470-5" tabindex="-1"></a>                      <span class="at">group =</span> Valence,</span>
<span id="cb470-6"><a href="第十二讲数据可视化进阶.html#cb470-6" tabindex="-1"></a>                      <span class="at">color =</span> Valence)) <span class="sc">+</span></span>
<span id="cb470-7"><a href="第十二讲数据可视化进阶.html#cb470-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb470-8"><a href="第十二讲数据可视化进阶.html#cb470-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb470-9"><a href="第十二讲数据可视化进阶.html#cb470-9" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb470-10"><a href="第十二讲数据可视化进阶.html#cb470-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>grand_mean_RT<span class="sc">-</span>SE_RT,</span>
<span id="cb470-11"><a href="第十二讲数据可视化进阶.html#cb470-11" tabindex="-1"></a>                             <span class="at">ymax=</span>grand_mean_RT<span class="sc">+</span>SE_RT),</span>
<span id="cb470-12"><a href="第十二讲数据可视化进阶.html#cb470-12" tabindex="-1"></a>                         <span class="at">width=</span>.<span class="dv">1</span>,</span>
<span id="cb470-13"><a href="第十二讲数据可视化进阶.html#cb470-13" tabindex="-1"></a>                         <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb470-14"><a href="第十二讲数据可视化进阶.html#cb470-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>)) <span class="sc">+</span> <span class="co">#选取能纳入全部散点的范围</span></span>
<span id="cb470-15"><a href="第十二讲数据可视化进阶.html#cb470-15" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span>
<span id="cb470-16"><a href="第十二讲数据可视化进阶.html#cb470-16" tabindex="-1"></a></span>
<span id="cb470-17"><a href="第十二讲数据可视化进阶.html#cb470-17" tabindex="-1"></a>s1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-273-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>接下来我们希望加入每个被试的数据点，依然使用<code>geom_point()</code>这个函数，可以注意到这里用到的是每个被试的数据<code>df.match.subj</code>，而不是前面的<code>df.match.sum</code>，代表每个被试在4种实验条件下的均值。下面是相应的代码。</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="第十二讲数据可视化进阶.html#cb471-1" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb471-2"><a href="第十二讲数据可视化进阶.html#cb471-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.subj,</span>
<span id="cb471-3"><a href="第十二讲数据可视化进阶.html#cb471-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> Identity,</span>
<span id="cb471-4"><a href="第十二讲数据可视化进阶.html#cb471-4" tabindex="-1"></a>                          <span class="at">y =</span> RT_mean,</span>
<span id="cb471-5"><a href="第十二讲数据可视化进阶.html#cb471-5" tabindex="-1"></a>                          <span class="at">group =</span> Valence))</span>
<span id="cb471-6"><a href="第十二讲数据可视化进阶.html#cb471-6" tabindex="-1"></a></span>
<span id="cb471-7"><a href="第十二讲数据可视化进阶.html#cb471-7" tabindex="-1"></a>s2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-274-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到确实把被试的数据点画了出来，但是似乎不是很美观，所有点都叠在一起。于是我们使用<code>position = position_jitter(width = 0.1)</code>这一语句将数据点抖动错开。</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="第十二讲数据可视化进阶.html#cb472-1" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb472-2"><a href="第十二讲数据可视化进阶.html#cb472-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.subj,</span>
<span id="cb472-3"><a href="第十二讲数据可视化进阶.html#cb472-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> Identity, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Valence),</span>
<span id="cb472-4"><a href="第十二讲数据可视化进阶.html#cb472-4" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb472-5"><a href="第十二讲数据可视化进阶.html#cb472-5" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb472-6"><a href="第十二讲数据可视化进阶.html#cb472-6" tabindex="-1"></a></span>
<span id="cb472-7"><a href="第十二讲数据可视化进阶.html#cb472-7" tabindex="-1"></a>s3</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-275-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>但是我们发现数据点还是没有完全错开，moral和immoral两种条件下面的点还是混杂在一起。那么应该如何得到规律的抖动呢？可以看到上面的点是根据x轴的两个条件在进行抖动错开，实际上我们需要点根据moral和immoral进行抖动错开，因此我们需要设置新的基线。</p>
<p>我们加入新的位置变量conds。首先我们需要明白，虽然坐标轴上我们看到的x是self和other，但实际上它们真实的值是0和1，因此我们需要设置4种情况，self下的两种情况下，坐标分别是1±0.12；而other条件下则是2±0.12。</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="第十二讲数据可视化进阶.html#cb473-1" tabindex="-1"></a>df.match.plot <span class="ot">&lt;-</span> df.match.subj <span class="sc">%&gt;%</span></span>
<span id="cb473-2"><a href="第十二讲数据可视化进阶.html#cb473-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">conds =</span> <span class="fu">case_when</span>(Identity <span class="sc">==</span> <span class="st">&quot;Self&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;moral&quot;</span> <span class="sc">~</span> <span class="st">&quot;0.88&quot;</span>,</span>
<span id="cb473-3"><a href="第十二讲数据可视化进阶.html#cb473-3" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Self&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;immoral&quot;</span> <span class="sc">~</span> <span class="st">&quot;1.12&quot;</span>,</span>
<span id="cb473-4"><a href="第十二讲数据可视化进阶.html#cb473-4" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Other&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;moral&quot;</span> <span class="sc">~</span> <span class="st">&quot;1.88&quot;</span>,</span>
<span id="cb473-5"><a href="第十二讲数据可视化进阶.html#cb473-5" tabindex="-1"></a>                                  Identity <span class="sc">==</span> <span class="st">&quot;Other&quot;</span> <span class="sc">&amp;</span> Valence <span class="sc">==</span> <span class="st">&quot;immoral&quot;</span> <span class="sc">~</span> <span class="st">&quot;2.12&quot;</span>),</span>
<span id="cb473-6"><a href="第十二讲数据可视化进阶.html#cb473-6" tabindex="-1"></a>                <span class="at">conds =</span> <span class="fu">as.numeric</span>(conds))</span></code></pre></div>
<p>接下来讲conds作为x变量来画被试个体数据的点图。这时候点的基线就变成了conds下面的4种条件，而不是原来的self和other这两种基线。</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="第十二讲数据可视化进阶.html#cb474-1" tabindex="-1"></a>s4 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb474-2"><a href="第十二讲数据可视化进阶.html#cb474-2" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb474-3"><a href="第十二讲数据可视化进阶.html#cb474-3" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> conds, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Valence),</span>
<span id="cb474-4"><a href="第十二讲数据可视化进阶.html#cb474-4" tabindex="-1"></a>                       <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>),</span>
<span id="cb474-5"><a href="第十二讲数据可视化进阶.html#cb474-5" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb474-6"><a href="第十二讲数据可视化进阶.html#cb474-6" tabindex="-1"></a></span>
<span id="cb474-7"><a href="第十二讲数据可视化进阶.html#cb474-7" tabindex="-1"></a>s4</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-277-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这样以来，再把个体点图叠加到原来的整体线图上时，看上去就好像处于以整体的值为中心在进行变化。至于0.12这个偏差值如何设置呢？最好的办法就是多去试，然后看那个值最合适。</p>
<p>当我们画出被试散点之后，我们还希望看到被试个体的趋势，因此我们在s4的基础上再将被试的条件值连接起来。</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="第十二讲数据可视化进阶.html#cb475-1" tabindex="-1"></a>s5 <span class="ot">&lt;-</span> s4 <span class="sc">+</span></span>
<span id="cb475-2"><a href="第十二讲数据可视化进阶.html#cb475-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb475-3"><a href="第十二讲数据可视化进阶.html#cb475-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> conds, <span class="at">y =</span> RT_mean, <span class="at">group =</span> Sub),</span>
<span id="cb475-4"><a href="第十二讲数据可视化进阶.html#cb475-4" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb475-5"><a href="第十二讲数据可视化进阶.html#cb475-5" tabindex="-1"></a>                     <span class="at">size=</span><span class="fl">0.8</span>,</span>
<span id="cb475-6"><a href="第十二讲数据可视化进阶.html#cb475-6" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb475-7"><a href="第十二讲数据可视化进阶.html#cb475-7" tabindex="-1"></a>                     <span class="at">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb475-8"><a href="第十二讲数据可视化进阶.html#cb475-8" tabindex="-1"></a></span>
<span id="cb475-9"><a href="第十二讲数据可视化进阶.html#cb475-9" tabindex="-1"></a>s5</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-278-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>可以看到线和点的对应关系不是很好，线很齐而点很散，导致线的开头和点没有很好地对应在一起。那么如何使点和线正确连接呢？我们需要将点和线放在同一段代码下进行绘制，并且设置一致的dodge值，同时我们将个体值的透明度降低，让整体值的颜色更加凸显。</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="第十二讲数据可视化进阶.html#cb476-1" tabindex="-1"></a>s6 <span class="ot">&lt;-</span> s1 <span class="sc">+</span></span>
<span id="cb476-2"><a href="第十二讲数据可视化进阶.html#cb476-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb476-3"><a href="第十二讲数据可视化进阶.html#cb476-3" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> conds,</span>
<span id="cb476-4"><a href="第十二讲数据可视化进阶.html#cb476-4" tabindex="-1"></a>                           <span class="at">y =</span> RT_mean,</span>
<span id="cb476-5"><a href="第十二讲数据可视化进阶.html#cb476-5" tabindex="-1"></a>                           <span class="at">group =</span> <span class="fu">as.factor</span>(Sub)),</span>
<span id="cb476-6"><a href="第十二讲数据可视化进阶.html#cb476-6" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.08</span>),</span>
<span id="cb476-7"><a href="第十二讲数据可视化进阶.html#cb476-7" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb476-8"><a href="第十二讲数据可视化进阶.html#cb476-8" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb476-9"><a href="第十二讲数据可视化进阶.html#cb476-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> df.match.plot,</span>
<span id="cb476-10"><a href="第十二讲数据可视化进阶.html#cb476-10" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> conds,</span>
<span id="cb476-11"><a href="第十二讲数据可视化进阶.html#cb476-11" tabindex="-1"></a>                         <span class="at">y =</span> RT_mean,</span>
<span id="cb476-12"><a href="第十二讲数据可视化进阶.html#cb476-12" tabindex="-1"></a>                         <span class="at">group =</span> <span class="fu">as.factor</span>(Sub)),</span>
<span id="cb476-13"><a href="第十二讲数据可视化进阶.html#cb476-13" tabindex="-1"></a>                     <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.08</span>),</span>
<span id="cb476-14"><a href="第十二讲数据可视化进阶.html#cb476-14" tabindex="-1"></a>                     <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb476-15"><a href="第十二讲数据可视化进阶.html#cb476-15" tabindex="-1"></a>                     <span class="at">size=</span><span class="fl">0.8</span>,</span>
<span id="cb476-16"><a href="第十二讲数据可视化进阶.html#cb476-16" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">&quot;#000000&quot;</span>,</span>
<span id="cb476-17"><a href="第十二讲数据可视化进阶.html#cb476-17" tabindex="-1"></a>                     <span class="at">alpha=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb476-18"><a href="第十二讲数据可视化进阶.html#cb476-18" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;RT&quot;</span>)</span>
<span id="cb476-19"><a href="第十二讲数据可视化进阶.html#cb476-19" tabindex="-1"></a></span>
<span id="cb476-20"><a href="第十二讲数据可视化进阶.html#cb476-20" tabindex="-1"></a>s6</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-279-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>这时就可以看到连接在一起的被试的点和线。这是<code>ggplot2</code>画图的一个好处，当在同一个图层上叠加<code>position</code>和<code>dodge</code>时，不同几何图形之间的抖动错开是会进行自动对应的。同理可得ACC的图如下。</p>
<p><img src="_main_files/figure-html/unnamed-chunk-280-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>包含了个体数据的图信息更为全面，并且方便我们去判断实验操作的真实效果。可以看到虽然对于实验来说整体操纵是有效的，但对每一个被试来说心理学的操纵并不一定是有效的，数据在不同被试间的变异性是很强的。这和前面几章讲到的层级模型的思想是一致的，即既要捕捉整体趋势，也要捕捉个体趋势。</p>
<p>我们继续使用<code>patchwork</code>进行拼图，然后保存为pdf，保存的时候可以调整图片的宽高，因为pdf保存的图片是矢量图，因此用于投稿或者插入文章都是可行的。</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="第十二讲数据可视化进阶.html#cb477-1" tabindex="-1"></a>s9 <span class="ot">&lt;-</span> s6 <span class="sc">+</span> s8 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb477-2"><a href="第十二讲数据可视化进阶.html#cb477-2" tabindex="-1"></a>s9</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-281-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="第十二讲数据可视化进阶.html#cb478-1" tabindex="-1"></a><span class="co"># 保存为pdf更加清晰</span></span>
<span id="cb478-2"><a href="第十二讲数据可视化进阶.html#cb478-2" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;./pic/chp12/p1.pdf&quot;</span>, </span>
<span id="cb478-3"><a href="第十二讲数据可视化进阶.html#cb478-3" tabindex="-1"></a>                <span class="at">plot =</span> s9, </span>
<span id="cb478-4"><a href="第十二讲数据可视化进阶.html#cb478-4" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">8</span>, </span>
<span id="cb478-5"><a href="第十二讲数据可视化进阶.html#cb478-5" tabindex="-1"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="可视化层级模型的random-effect" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> 可视化层级模型的random effect<a href="第十二讲数据可视化进阶.html#可视化层级模型的random-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我们之前提到过层级模型的随机效应，这里我们简单展示了如何将每个被试random effect中的截距进行可视化。</p>
<p><img src="pic/chp12/target2.png" /></p>
<p>我们选取12名被试的数据进行一个简单的建模，随机效应只加入一个随机的截距。</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="第十二讲数据可视化进阶.html#cb479-1" tabindex="-1"></a><span class="co">#此处选择12个被试是为了在展示的时候更清晰</span></span>
<span id="cb479-2"><a href="第十二讲数据可视化进阶.html#cb479-2" tabindex="-1"></a>sublist <span class="ot">&lt;-</span> <span class="fu">unique</span>(df.match.trial<span class="sc">$</span>Sub)</span>
<span id="cb479-3"><a href="第十二讲数据可视化进阶.html#cb479-3" tabindex="-1"></a>target2 <span class="ot">&lt;-</span> df.match.trial <span class="sc">%&gt;%</span> </span>
<span id="cb479-4"><a href="第十二讲数据可视化进阶.html#cb479-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Sub <span class="sc">==</span> sublist[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb479-5"><a href="第十二讲数据可视化进阶.html#cb479-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">factor</span>(Label, </span>
<span id="cb479-6"><a href="第十二讲数据可视化进阶.html#cb479-6" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;moralSelf&quot;</span>, <span class="st">&quot;moralOther&quot;</span>, <span class="st">&quot;immoralSelf&quot;</span>, <span class="st">&quot;immoralOther&quot;</span>)),</span>
<span id="cb479-7"><a href="第十二讲数据可视化进阶.html#cb479-7" tabindex="-1"></a>                <span class="at">Sub =</span> <span class="fu">factor</span>(Sub))</span>
<span id="cb479-8"><a href="第十二讲数据可视化进阶.html#cb479-8" tabindex="-1"></a></span>
<span id="cb479-9"><a href="第十二讲数据可视化进阶.html#cb479-9" tabindex="-1"></a>model <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">data =</span> target2,</span>
<span id="cb479-10"><a href="第十二讲数据可视化进阶.html#cb479-10" tabindex="-1"></a>                    RT <span class="sc">~</span> Identity <span class="sc">*</span> Valence <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Sub)) </span></code></pre></div>
<p>接着我们使用<code>ranef(model)\$Sub</code>将模型中被试的随机效应提取出来，并对”(Intercept)“进行重新命名。标准差可以从variance covariance matrix中提取出来，因为只有一个随机效应，因此用<code>sqrt(diag(vcov(model))[1]</code>就可以直接提取然后开平方变成标准误。接着为了美观，使用<code>arrange()</code>进行排序，<code>factor()</code>用于将被试这一数字变量因子化，否则排序将会没有效果。</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="第十二讲数据可视化进阶.html#cb480-1" tabindex="-1"></a><span class="co"># 提取随机效应</span></span>
<span id="cb480-2"><a href="第十二讲数据可视化进阶.html#cb480-2" tabindex="-1"></a>ranef_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>Sub) <span class="sc">%&gt;%</span></span>
<span id="cb480-3"><a href="第十二讲数据可视化进阶.html#cb480-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Sub =</span> <span class="fu">row.names</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb480-4"><a href="第十二讲数据可视化进阶.html#cb480-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb480-5"><a href="第十二讲数据可视化进阶.html#cb480-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(model))[<span class="dv">1</span>]),</span>
<span id="cb480-6"><a href="第十二讲数据可视化进阶.html#cb480-6" tabindex="-1"></a>                <span class="at">lower =</span> Intercept <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span>se,</span>
<span id="cb480-7"><a href="第十二讲数据可视化进阶.html#cb480-7" tabindex="-1"></a>                <span class="at">upper =</span> Intercept <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span>se) <span class="sc">%&gt;%</span></span>
<span id="cb480-8"><a href="第十二讲数据可视化进阶.html#cb480-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Intercept) <span class="sc">%&gt;%</span></span>
<span id="cb480-9"><a href="第十二讲数据可视化进阶.html#cb480-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Sub =</span> <span class="fu">factor</span>(Sub, <span class="at">levels =</span> .<span class="sc">$</span>Sub))</span></code></pre></div>
<p>接着我们使用ggplot绘制森林图。<code>geom_vline()</code>函数用于绘制<code>x = 0</code>上面的虚线。</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="第十二讲数据可视化进阶.html#cb481-1" tabindex="-1"></a><span class="co"># 绘制森林图</span></span>
<span id="cb481-2"><a href="第十二讲数据可视化进阶.html#cb481-2" tabindex="-1"></a>ranef_df <span class="sc">%&gt;%</span> </span>
<span id="cb481-3"><a href="第十二讲数据可视化进阶.html#cb481-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x=</span>Intercept, <span class="at">y=</span>Sub)) <span class="sc">+</span></span>
<span id="cb481-4"><a href="第十二讲数据可视化进阶.html#cb481-4" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb481-5"><a href="第十二讲数据可视化进阶.html#cb481-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmax =</span> upper, <span class="at">xmin =</span> lower), </span>
<span id="cb481-6"><a href="第十二讲数据可视化进阶.html#cb481-6" tabindex="-1"></a>                          <span class="at">height =</span> .<span class="dv">2</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb481-7"><a href="第十二讲数据可视化进阶.html#cb481-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb481-8"><a href="第十二讲数据可视化进阶.html#cb481-8" tabindex="-1"></a>  <span class="co"># ggplot2::facet_wrap(~ variable, nrow = 1) + # 按照对象分面</span></span>
<span id="cb481-9"><a href="第十二讲数据可视化进阶.html#cb481-9" tabindex="-1"></a>  papaja<span class="sc">::</span><span class="fu">theme_apa</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-285-1.png" width="672" style="display: block; margin: auto;" />
<img src="pic/chp12/forest.png" /></p>
<p>森林图中点距离虚线的距离，代表的就是被试偏离整体”intercept”的多少，例如7313号被试intercept和整体偏差了100ms的反应时，这在反应时上是一个相当大的差距；再比如7313和7314被试的intercept差距达到了200ms，这是一个更大的效应，足以说明被试之间的差异是很大的。</p>
</div>
<div id="雨云图rain-cloud-plot" class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> 雨云图（rain cloud plot）<a href="第十二讲数据可视化进阶.html#雨云图rain-cloud-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>为了进一步展示数据的分布情况，可以使用雨云图来进行展现。当研究者提出呈现个体数据重要性的时候，雨云图得到了广泛的引用，这一小工具甚至可以说改变了整个科研界使用可视化的方式。
<img src="pic/chp12/target3.png" /></p>
<p>雨云图的代码讲解在此不做赘述，请读者自行运行下面这些<code>include=FALSE</code>的代码。</p>
</div>
</div>
<div id="高级图片处理-magick" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> 高级图片处理 – <code>magick</code><a href="第十二讲数据可视化进阶.html#高级图片处理-magick" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code>生成的图像有时需要进一步手动修改（如修改图片格式、图片拼接等），也可能需要批量修改一些通过其他途径得到的图，R仍然可以处理：<a href="https://search.r-project.org/CRAN/refmans/magick/html/magick.html"><code>magick</code>包</a>可以应用于所有常见图片操作(甚至包括PDF)，具体功能可以参考相关文档(<a href="https://search.r-project.org/CRAN/refmans/magick/html/magick.html" class="uri">https://search.r-project.org/CRAN/refmans/magick/html/magick.html</a>)，在这里我们仅以图片剪裁与拼接为例。</p>
<p><img src="pic/chp12/r.jpg" /></p>
<p>假设我们希望这两张图变为横向排版，那么首先需要对图片进行剪裁，然后进行横向拼接。</p>
<p><img src="pic/chp6/pr1.png" /></p>
<p>首先我们读取和查看这张本地图片的信息。</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="第十二讲数据可视化进阶.html#cb482-1" tabindex="-1"></a><span class="do">## 读取图片；图片可以是本地，也可以是图片的网址链接</span></span>
<span id="cb482-2"><a href="第十二讲数据可视化进阶.html#cb482-2" tabindex="-1"></a>img <span class="ot">=</span> magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">&#39;pic/chp6/pr1.png&#39;</span>)</span>
<span id="cb482-3"><a href="第十二讲数据可视化进阶.html#cb482-3" tabindex="-1"></a></span>
<span id="cb482-4"><a href="第十二讲数据可视化进阶.html#cb482-4" tabindex="-1"></a><span class="do">## 查看图片相关信息</span></span>
<span id="cb482-5"><a href="第十二讲数据可视化进阶.html#cb482-5" tabindex="-1"></a>img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_info</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG      870    977 sRGB       FALSE    92033 72x72</code></pre>
<p>下面需要根据图片的width 和 height
，使用<code>magick::image_crop()</code>进行裁剪，<code>geometry</code>参数接受一个字符串，来对剪裁区域进行定位，比如<code>"850x480+10+10"</code>。这个字符串包含两个部分:<br />
第一部分：包含图片剪裁的长和宽（单位可以是百分比，但下面会使用像素），即<code>"850x480"</code>（注意：其中连接符为小写字母x），大概指右图中红色线条;<br />
第二部分：包含起始点位置，即<code>"+10+10"</code>，意思是从左上角顶点向右10个像素，向下10个像素，大概对应右图中灰色点的位置，如果不写默认使用<code>+0+0</code>（即左上角顶点）。</p>
<p><img src="pic/chp12/crop_gram.jpg" /></p>
<p>我们使用下面代码对图片进行剪切。</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="第十二讲数据可视化进阶.html#cb484-1" tabindex="-1"></a>img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;850x480+10+10&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-288-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>接下来我们将下半部分的图也剪切下来，然后进行拼接。</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="第十二讲数据可视化进阶.html#cb485-1" tabindex="-1"></a>img1 <span class="ot">=</span> img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;870x488&#39;</span>)</span>
<span id="cb485-2"><a href="第十二讲数据可视化进阶.html#cb485-2" tabindex="-1"></a>img2 <span class="ot">=</span> img <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_crop</span>(<span class="st">&#39;870x488+0+485&#39;</span>)</span>
<span id="cb485-3"><a href="第十二讲数据可视化进阶.html#cb485-3" tabindex="-1"></a><span class="do">## 使用image_append进行拼接，令stack = F进行横向拼接（T为竖向）</span></span>
<span id="cb485-4"><a href="第十二讲数据可视化进阶.html#cb485-4" tabindex="-1"></a>img3 <span class="ot">=</span> <span class="fu">image_append</span>(<span class="fu">c</span>(img1,img2),<span class="at">stack =</span> F) <span class="co">#&lt;&lt;</span></span>
<span id="cb485-5"><a href="第十二讲数据可视化进阶.html#cb485-5" tabindex="-1"></a>img3 <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG     1740    488 sRGB       FALSE        0 72x72</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-289-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><code>magick</code>还有一些其他的功能，可以参考下面的代码。</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="第十二讲数据可视化进阶.html#cb487-1" tabindex="-1"></a><span class="do">#### NOT RUN ####</span></span>
<span id="cb487-2"><a href="第十二讲数据可视化进阶.html#cb487-2" tabindex="-1"></a><span class="co"># 保存图片到本地</span></span>
<span id="cb487-3"><a href="第十二讲数据可视化进阶.html#cb487-3" tabindex="-1"></a><span class="fu">image_write</span>(<span class="at">image =</span> img3,<span class="at">path =</span> <span class="st">&#39;your path&#39;</span>)</span>
<span id="cb487-4"><a href="第十二讲数据可视化进阶.html#cb487-4" tabindex="-1"></a><span class="co"># 修改尺寸(可以以像素为单位，这里以百分比为例)</span></span>
<span id="cb487-5"><a href="第十二讲数据可视化进阶.html#cb487-5" tabindex="-1"></a><span class="fu">image_scale</span>(img1,<span class="st">&#39;40%&#39;</span>)</span>
<span id="cb487-6"><a href="第十二讲数据可视化进阶.html#cb487-6" tabindex="-1"></a><span class="co"># 旋转</span></span>
<span id="cb487-7"><a href="第十二讲数据可视化进阶.html#cb487-7" tabindex="-1"></a><span class="fu">image_rotate</span>(img1,<span class="dv">90</span>)</span>
<span id="cb487-8"><a href="第十二讲数据可视化进阶.html#cb487-8" tabindex="-1"></a><span class="co"># OCR(这里以英文为例，中文的识别率经测验确实不太行😢)</span></span>
<span id="cb487-9"><a href="第十二讲数据可视化进阶.html#cb487-9" tabindex="-1"></a><span class="fu">image_read</span>(<span class="st">&quot;http://jeroen.github.io/images/testocr.png&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb487-10"><a href="第十二讲数据可视化进阶.html#cb487-10" tabindex="-1"></a>  <span class="fu">image_ocr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb487-11"><a href="第十二讲数据可视化进阶.html#cb487-11" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div>
<p>有读者可能会问，为什么要用<code>magick</code>而不用Photoshop来进行手工操作呢？第一，用代码可以实现精确的复制，不会每次都产生一点手工的误差；第二，加入实验过程中又收了一个被试，实验图片发生了一些微小的变化，如果用PS就要全部手工操作一遍，而用代码只要原样跑一遍即可。</p>
<p>最后，我们附上一些<code>ggplot2</code>的参考网页，读者可以自行阅览。</p>
<ul>
<li>ggplot2常用参数与函数汇总：<a href="https://zhuanlan.zhihu.com/p/637483028" class="uri">https://zhuanlan.zhihu.com/p/637483028</a></li>
<li>ggplot2位置调整参数：<a href="https://zhuanlan.zhihu.com/p/409489632" class="uri">https://zhuanlan.zhihu.com/p/409489632</a></li>
<li>ggplot2主题总结：<a href="https://zhuanlan.zhihu.com/p/463041897" class="uri">https://zhuanlan.zhihu.com/p/463041897</a></li>
<li>ggplot2分面总结：<a href="https://zhuanlan.zhihu.com/p/225852640" class="uri">https://zhuanlan.zhihu.com/p/225852640</a></li>
<li>patchwork常用功能：<a href="https://zhuanlan.zhihu.com/p/384456335" class="uri">https://zhuanlan.zhihu.com/p/384456335</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第十一讲回归模型四中介分析.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="第十三讲基于网络模型的心理学研究.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hcp4715/R4PsyBook/tree/main/Book/1012-lesson12_2024.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
